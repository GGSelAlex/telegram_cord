import telebot
import os
from flask import Flask, request

# === 1. –û—Ç—Ä–∏–º—É—î–º–æ —Ç–æ–∫–µ–Ω —ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ ===
TOKEN = os.getenv("BOT_TOKEN")
ADMIN_IDS = [int(os.getenv("8208162262")), int(os.getenv("8411342070"))]  # ID –¥–≤–æ—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
bot = telebot.TeleBot(TOKEN)

# === 2. Flask-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Webhook ===
app = Flask(__name__)

@app.route('/' + TOKEN, methods=['POST'])
def getMessage():
    bot.process_new_updates([telebot.types.Update.de_json(request.stream.read().decode("utf-8"))])
    return "!", 200

@app.route("/")
def webhook():
    bot.remove_webhook()
    bot.set_webhook(url=f"https://{os.getenv('RENDER_EXTERNAL_HOSTNAME')}/{TOKEN}")
    return "Bot is running via webhook", 200


# === 3. –°—Ç–∞—Ä—Ç —Ç–∞ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É ===
@bot.message_handler(commands=['start'])
def start(message):
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.row("‚öñÔ∏è –ü–æ—Å–ª—É–≥–∏", "üïí –ó–∞–ø–∏—Å –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é")
    markup.row("‚ÑπÔ∏è –ü—Ä–æ –∫–æ–º–ø–∞–Ω—ñ—é", "üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è")

    welcome_text = (
        "üíº *–Æ—Ä–∏–¥–∏—á–Ω—ñ –ø–æ—Å–ª—É–≥–∏ Kovalova Stanislava*\n\n"
        "–í—ñ—Ç–∞—î–º–æ –≤–∞—Å —É –ø—Ä–µ–º—ñ—É–º —é—Ä–∏–¥–∏—á–Ω–æ–º—É —Å–µ—Ä–≤—ñ—Å—ñ.\n"
        "–û–±–µ—Ä—ñ—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Ä–æ–∑–¥—ñ–ª –Ω–∏–∂—á–µ üëá"
    )
    bot.send_message(message.chat.id, welcome_text, parse_mode="Markdown", reply_markup=markup)

    # –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É
    for admin_id in ADMIN_IDS:
        bot.send_message(admin_id, f"–ù–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–Ω—É–≤ /start: @{message.from_user.username} ({message.chat.id})")


# === 4. –ü–æ—Å–ª—É–≥–∏ ===

# --- –í–ò–á–ó–î ---
@bot.message_handler(func=lambda m: m.text == "–í–ò–á–ó–î")
def service_exit(message):
    text = (
        "üí≥ *–ë—ñ–ª–∏–π –∫–≤–∏—Ç–æ–∫: –í–∞—à –®–ª—è—Ö –¥–æ –°–≤–æ–±–æ–¥–∏ —Ç–∞ –°–ø–æ–∫–æ—é*\n\n"
        "–ü—Ä–æ–ø–æ–Ω—É—î–º–æ –ø–æ—Å–ª—É–≥—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è *–ë—ñ–ª–æ–≥–æ –∫–≤–∏—Ç–∫–∞*.\n\n"
        "üìå *–©–æ –≤—Ö–æ–¥–∏—Ç—å —É –ø–æ—Å–ª—É–≥—É:*\n"
        "‚Ä¢ –î–æ–ø–æ–º–æ–≥–∞ –≤ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ñ –ë—ñ–ª–æ–≥–æ –∫–≤–∏—Ç–∫–∞\n"
        "‚Ä¢ –ü—ñ–¥–±—ñ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—ó —Å—Ç–∞—Ç—Ç—ñ –ó–∞–∫–æ–Ω—É\n"
        "‚Ä¢ –û—Ñ—ñ—Ü—ñ–π–Ω–µ –∑–∞–∫–ª—é—á–µ–Ω–Ω—è –í–õ–ö\n"
        "‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç–∞–ª—å–Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—É –Ω–∞ –≤–∏—ó–∑–¥\n"
        "‚Ä¢ –ü–æ–≤–Ω–µ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –∑ –≤—ñ–π—Å—å–∫–æ–≤–æ–≥–æ –æ–±–ª—ñ–∫—É\n\n"
        "üìÑ *–î–æ–∫—É–º–µ–Ω—Ç–∏, —è–∫—ñ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ:*\n"
        "‚Ä¢ –¢–∏–º—á–∞—Å–æ–≤–µ –ø–æ—Å–≤—ñ–¥—á–µ–Ω–Ω—è\n"
        "‚Ä¢ –í–õ–ö\n"
        "‚Ä¢ –î–æ–≤—ñ–¥–∫–∞ –Ω–∞ –ø—Ä–∞–≤–æ –≤–∏—ó–∑–¥—É\n\n"
        "‚úÖ *–ü–µ—Ä–µ–≤–∞–≥–∏:*\n"
        "‚Ä¢ –ü–æ–≤–Ω–∞ –ª–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å\n"
        "‚Ä¢ –®–≤–∏–¥–∫—ñ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è 14-16 –¥–Ω—ñ–≤\n"
        "‚Ä¢ –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å\n"
        "‚Ä¢ –°–≤–æ–±–æ–¥–∞ –ø–µ—Ä–µ—Å—É–≤–∞–Ω–Ω—è"
    )
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    markup.row("–ù–∞–∑–∞–¥", "üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è")
    bot.send_message(message.chat.id, text, parse_mode="Markdown", reply_markup=markup)


# --- –Ü–ù–í–ê–õ–Ü–î–ù–Ü–°–¢–¨ ---
@bot.message_handler(func=lambda m: m.text == "–Ü–ù–í–ê–õ–Ü–î–ù–Ü–°–¢–¨")
def service_disability(message):
    text = (
        "‚ôø *–ì—Ä—É–ø–∞ –Ü–Ω–≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ: –í–∞—à–µ –ü—Ä–∞–≤–æ –Ω–∞ –ó–∞—Ö–∏—Å—Ç —Ç–∞ –°–æ—Ü—ñ–∞–ª—å–Ω—ñ –ì–∞—Ä–∞–Ω—Ç—ñ—ó*\n\n"
        "–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ –ø–æ—Å–ª—É–≥–∞ –∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –≥—Ä—É–ø–∏ —ñ–Ω–≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ (–Ü–Ü –∞–±–æ –Ü–Ü–Ü), —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î "
        "–≤—ñ–¥—Å—Ç—Ä–æ—á–∫—É –≤—ñ–¥ –º–æ–±—ñ–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –¥–æ—Å—Ç—É–ø –¥–æ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –≤–∏–ø–ª–∞—Ç.\n\n"
        "üìå *–©–æ –≤—Ö–æ–¥–∏—Ç—å —É –ø–æ—Å–ª—É–≥—É:*\n"
        "‚Ä¢ –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –Ü–Ü –∞–±–æ –Ü–Ü–Ü –≥—Ä—É–ø–∏ —ñ–Ω–≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ\n"
        "‚Ä¢ –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–µ–¥–∏—á–Ω–æ—ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó\n"
        "‚Ä¢ –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–≤—ñ–¥–æ–∫ –ú–°–ï–ö\n"
        "‚Ä¢ –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–µ—Ä–º—ñ–Ω—É —ñ–Ω–≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ\n"
        "‚Ä¢ –û—Ñ—ñ—Ü—ñ–π–Ω–∞ –≤—ñ–¥—Å—Ç—Ä–æ—á–∫–∞ –≤—ñ–¥ –º–æ–±—ñ–ª—ñ–∑–∞—Ü—ñ—ó\n"
        "‚Ä¢ –ü–æ–≤–Ω–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –ø–æ –±–∞–∑–∞—Ö —Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ö\n"
        "‚Ä¢ –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–µ–Ω—Å—ñ–π–Ω–∏—Ö –≤–∏–ø–ª–∞—Ç\n\n"
        "üìÑ *–î–æ–∫—É–º–µ–Ω—Ç–∏, —è–∫—ñ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ:*\n"
        "‚Ä¢ –í–õ–ö\n"
        "‚Ä¢ –î–æ–≤—ñ–¥–∫—É –ï–ö–û–ü–§ (–ú–°–ï–ö)\n"
        "‚Ä¢ –ü—Ä–∞–≤–æ –Ω–∞ –ø–µ–Ω—Å—ñ—é\n\n"
        "‚úÖ *–ü–µ—Ä–µ–≤–∞–≥–∏:*\n"
        "‚Ä¢ –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∞ –≤—ñ–¥—Å—Ç—Ä–æ—á–∫–∞\n"
        "‚Ä¢ –°–æ—Ü—ñ–∞–ª—å–Ω—ñ –≥–∞—Ä–∞–Ω—Ç—ñ—ó\n"
        "‚Ä¢ –õ–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ –ø—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å\n"
        "‚Ä¢ –®–≤–∏–¥–∫–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è 14-18 –¥–Ω—ñ–≤"
    )
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    markup.row("–ù–∞–∑–∞–¥", "üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è")
    bot.send_message(message.chat.id, text, parse_mode="Markdown", reply_markup=markup)


# --- –í–Ü–î–¢–ï–†–ú–Ü–ù–£–í–ê–ù–ù–Ø ---
@bot.message_handler(func=lambda m: m.text == "–í–Ü–î–¢–ï–†–ú–Ü–ù–£–í–ê–ù–ù–Ø")
def service_postpone(message):
    text = (
        "‚è≥ *–í—ñ–¥—Ç–µ—Ä–º—ñ–Ω—É–≤–∞–Ω–Ω—è –º–æ–±—ñ–ª—ñ–∑–∞—Ü—ñ—ó: –õ–µ–≥–∞–ª—å–Ω–æ —Ç–∞ –®–≤–∏–¥–∫–æ*\n\n"
        "–í—ñ–¥—Å—Ç—Ä–æ—á–∫–∞ –Ω–∞ 1 —Ä—ñ–∫ –æ—Ñ–æ—Ä–º–ª—é—î—Ç—å—Å—è –ø–æ —Å—Ç–∞–Ω—É –∑–¥–æ—Ä–æ–≤'—è —á–µ—Ä–µ–∑ –í–õ–ö —É–ø—Ä–æ–¥–æ–≤–∂ 3-5 –¥–Ω—ñ–≤. "
        "–ü—ñ—Å–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø–æ–∫—ñ–π–Ω–æ –ø–µ—Ä–µ—Å—É–≤–∞—Ç–∏—Å—è –ø–æ –£–∫—Ä–∞—ó–Ω—ñ.\n\n"
        "üìå *–ü—Ä–æ—Ü–µ—Å –æ—Ç—Ä–∏–º–∞–Ω–Ω—è:*\n"
        "1Ô∏è‚É£ –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤\n"
        "2Ô∏è‚É£ –ù–∞–¥—Å–∏–ª–∞—î–º–æ —Ñ–æ—Ç–æ –≥–æ—Ç–æ–≤–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —Ç–∞ —Ñ–æ—Ç–æ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö *–û–±–µ—Ä–µ–≥*\n\n"
        "üìÑ *–î–æ–∫—É–º–µ–Ω—Ç–∏, —è–∫—ñ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ:*\n"
        "‚Ä¢ –¢–∏–º—á–∞—Å–æ–≤–µ –ø–æ—Å–≤—ñ–¥—á–µ–Ω–Ω—è\n"
        "‚Ä¢ –î–æ–≤—ñ–¥–∫—É (–≤—ñ–¥—Å—Ç—Ä–æ—á–∫–∞ –Ω–∞ —Ä—ñ–∫)\n"
        "‚Ä¢ –í–õ–ö\n\n"
        "‚úÖ *–ü–µ—Ä–µ–≤–∞–≥–∏:*\n"
        "‚Ä¢ –®–≤–∏–¥–∫–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è (3-5 –¥–Ω—ñ–≤)\n"
        "‚Ä¢ –õ–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ –æ—Ñ—ñ—Ü—ñ–π–Ω—ñ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤\n"
        "‚Ä¢ –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤—ñ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ—Å—É–≤–∞–Ω–Ω—è –ø–æ –£–∫—Ä–∞—ó–Ω—ñ"
    )
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    markup.row("–ù–∞–∑–∞–¥", "üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è")
    bot.send_message(message.chat.id, text, parse_mode="Markdown", reply_markup=markup)


# --- –ó–í–Ü–õ–¨–ù–ï–ù–ù–Ø ---
@bot.message_handler(func=lambda m: m.text == "–ó–í–Ü–õ–¨–ù–ï–ù–ù–Ø")
def service_release(message):
    text = (
        "üõ°Ô∏è *–ó–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –∑ –ó–°–£: –Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –ü—ñ–¥—Ö—ñ–¥ —Ç–∞ –Æ—Ä–∏–¥–∏—á–Ω—ñ –ì–∞—Ä–∞–Ω—Ç—ñ—ó*\n\n"
        "–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –∫–æ–∂–Ω–æ–≥–æ –≤–∏–ø–∞–¥–∫—É –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –∑ –ª–∞–≤ –ó–°–£ –≤ —Ä–∞–º–∫–∞—Ö —á–∏–Ω–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–æ–¥–∞–≤—Å—Ç–≤–∞.\n\n"
        "üìå *–ü–æ–∫—Ä–æ–∫–æ–≤–∏–π –ü–ª–∞–Ω:*\n"
        "1Ô∏è‚É£ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –≤–∞—à–æ–≥–æ –≤–∏–ø–∞–¥–∫—É\n"
        "2Ô∏è‚É£ –ó–±—ñ—Ä —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤\n"
        "3Ô∏è‚É£ –Æ—Ä–∏–¥–∏—á–Ω–∏–π —Å—É–ø—Ä–æ–≤—ñ–¥ —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—è –∑ –¥–µ—Ä–∂–∞–≤–Ω–∏–º–∏ –æ—Ä–≥–∞–Ω–∞–º–∏\n"
        "4Ô∏è‚É£ –ö–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–æ—Ü–µ—Å—É —Ç–∞ –∑–∞—Ö–∏—Å—Ç –≤–∞—à–∏—Ö —ñ–Ω—Ç–µ—Ä–µ—Å—ñ–≤\n"
        "5Ô∏è‚É£ –û—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–∞–∫–∞–∑—É –ø—Ä–æ –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è\n\n"
        "üìÑ *–î–æ–∫—É–º–µ–Ω—Ç–∏, —è–∫—ñ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ:*\n"
        "‚Ä¢ –ü–æ–≤–Ω–∏–π –ø–∞–∫–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è\n"
        "‚Ä¢ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫–æ–Ω–Ω–æ—Å—Ç—ñ –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è\n\n"
        "‚úÖ *–ü–µ—Ä–µ–≤–∞–≥–∏:*\n"
        "‚Ä¢ –Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥\n"
        "‚Ä¢ –ü–æ–≤–Ω–∏–π —é—Ä–∏–¥–∏—á–Ω–∏–π —Å—É–ø—Ä–æ–≤—ñ–¥\n"
        "‚Ä¢ –õ–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ –∑–∞—Ö–∏—Å—Ç —ñ–Ω—Ç–µ—Ä–µ—Å—ñ–≤"
    )
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    markup.row("–ù–∞–∑–∞–¥", "üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è")
    bot.send_message(message.chat.id, text, parse_mode="Markdown", reply_markup=markup)


# === 5. –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è ===
@bot.message_handler(func=lambda m: m.text == "üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è")
def contact(message):
    bot.send_message(
        message.chat.id,
        "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å, —â–æ–± –æ–¥—Ä–∞–∑—É –Ω–∞–ø–∏—Å–∞—Ç–∏ —é—Ä–∏—Å—Ç—É:\nüëâ [–ù–∞–ø–∏—Å–∞—Ç–∏ –ö–æ–≤–∞–ª–æ–≤—É](https://t.me/uristcord)",
        parse_mode="Markdown"
    )


# === 6. –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –Ω–∞–∑–∞–¥ ===
